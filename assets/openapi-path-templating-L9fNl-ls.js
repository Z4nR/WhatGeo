import{i as o,u as n,A as u,P as h}from"./apg-lite-D-f21cIx.js";function d(){this.grammarObject="grammarObject",this.rules=[],this.rules[0]={name:"path-template",lower:"path-template",index:0,isBkr:!1},this.rules[1]={name:"path-segment",lower:"path-segment",index:1,isBkr:!1},this.rules[2]={name:"slash",lower:"slash",index:2,isBkr:!1},this.rules[3]={name:"path-literal",lower:"path-literal",index:3,isBkr:!1},this.rules[4]={name:"template-expression",lower:"template-expression",index:4,isBkr:!1},this.rules[5]={name:"template-expression-param-name",lower:"template-expression-param-name",index:5,isBkr:!1},this.rules[6]={name:"pchar",lower:"pchar",index:6,isBkr:!1},this.rules[7]={name:"unreserved",lower:"unreserved",index:7,isBkr:!1},this.rules[8]={name:"pct-encoded",lower:"pct-encoded",index:8,isBkr:!1},this.rules[9]={name:"sub-delims",lower:"sub-delims",index:9,isBkr:!1},this.rules[10]={name:"ALPHA",lower:"alpha",index:10,isBkr:!1},this.rules[11]={name:"DIGIT",lower:"digit",index:11,isBkr:!1},this.rules[12]={name:"HEXDIG",lower:"hexdig",index:12,isBkr:!1},this.udts=[],this.rules[0].opcodes=[],this.rules[0].opcodes[0]={type:2,children:[1,2,6]},this.rules[0].opcodes[1]={type:4,index:2},this.rules[0].opcodes[2]={type:3,min:0,max:1/0},this.rules[0].opcodes[3]={type:2,children:[4,5]},this.rules[0].opcodes[4]={type:4,index:1},this.rules[0].opcodes[5]={type:4,index:2},this.rules[0].opcodes[6]={type:3,min:0,max:1},this.rules[0].opcodes[7]={type:4,index:1},this.rules[1].opcodes=[],this.rules[1].opcodes[0]={type:3,min:1,max:1/0},this.rules[1].opcodes[1]={type:1,children:[2,3]},this.rules[1].opcodes[2]={type:4,index:3},this.rules[1].opcodes[3]={type:4,index:4},this.rules[2].opcodes=[],this.rules[2].opcodes[0]={type:7,string:[47]},this.rules[3].opcodes=[],this.rules[3].opcodes[0]={type:3,min:1,max:1/0},this.rules[3].opcodes[1]={type:4,index:6},this.rules[4].opcodes=[],this.rules[4].opcodes[0]={type:2,children:[1,2,3]},this.rules[4].opcodes[1]={type:7,string:[123]},this.rules[4].opcodes[2]={type:4,index:5},this.rules[4].opcodes[3]={type:7,string:[125]},this.rules[5].opcodes=[],this.rules[5].opcodes[0]={type:3,min:1,max:1/0},this.rules[5].opcodes[1]={type:1,children:[2,3,4]},this.rules[5].opcodes[2]={type:5,min:0,max:122},this.rules[5].opcodes[3]={type:6,string:[124]},this.rules[5].opcodes[4]={type:5,min:126,max:1114111},this.rules[6].opcodes=[],this.rules[6].opcodes[0]={type:1,children:[1,2,3,4,5]},this.rules[6].opcodes[1]={type:4,index:7},this.rules[6].opcodes[2]={type:4,index:8},this.rules[6].opcodes[3]={type:4,index:9},this.rules[6].opcodes[4]={type:7,string:[58]},this.rules[6].opcodes[5]={type:7,string:[64]},this.rules[7].opcodes=[],this.rules[7].opcodes[0]={type:1,children:[1,2,3,4,5,6]},this.rules[7].opcodes[1]={type:4,index:10},this.rules[7].opcodes[2]={type:4,index:11},this.rules[7].opcodes[3]={type:7,string:[45]},this.rules[7].opcodes[4]={type:7,string:[46]},this.rules[7].opcodes[5]={type:7,string:[95]},this.rules[7].opcodes[6]={type:7,string:[126]},this.rules[8].opcodes=[],this.rules[8].opcodes[0]={type:2,children:[1,2,3]},this.rules[8].opcodes[1]={type:7,string:[37]},this.rules[8].opcodes[2]={type:4,index:12},this.rules[8].opcodes[3]={type:4,index:12},this.rules[9].opcodes=[],this.rules[9].opcodes[0]={type:1,children:[1,2,3,4,5,6,7,8,9,10,11]},this.rules[9].opcodes[1]={type:7,string:[33]},this.rules[9].opcodes[2]={type:7,string:[36]},this.rules[9].opcodes[3]={type:7,string:[38]},this.rules[9].opcodes[4]={type:7,string:[39]},this.rules[9].opcodes[5]={type:7,string:[40]},this.rules[9].opcodes[6]={type:7,string:[41]},this.rules[9].opcodes[7]={type:7,string:[42]},this.rules[9].opcodes[8]={type:7,string:[43]},this.rules[9].opcodes[9]={type:7,string:[44]},this.rules[9].opcodes[10]={type:7,string:[59]},this.rules[9].opcodes[11]={type:7,string:[61]},this.rules[10].opcodes=[],this.rules[10].opcodes[0]={type:1,children:[1,2]},this.rules[10].opcodes[1]={type:5,min:65,max:90},this.rules[10].opcodes[2]={type:5,min:97,max:122},this.rules[11].opcodes=[],this.rules[11].opcodes[0]={type:5,min:48,max:57},this.rules[12].opcodes=[],this.rules[12].opcodes[0]={type:1,children:[1,2,3,4,5,6,7]},this.rules[12].opcodes[1]={type:4,index:11},this.rules[12].opcodes[2]={type:7,string:[97]},this.rules[12].opcodes[3]={type:7,string:[98]},this.rules[12].opcodes[4]={type:7,string:[99]},this.rules[12].opcodes[5]={type:7,string:[100]},this.rules[12].opcodes[6]={type:7,string:[101]},this.rules[12].opcodes[7]={type:7,string:[102]},this.toString=function(){let e="";return e+=`; OpenAPI Path Templating ABNF syntax
`,e+=`; variant of https://datatracker.ietf.org/doc/html/rfc3986#section-3.3
`,e+=`path-template                  = slash *( path-segment slash ) [ path-segment ]
`,e+=`path-segment                   = 1*( path-literal / template-expression )
`,e+=`slash                          = "/"
`,e+=`path-literal                   = 1*pchar
`,e+=`template-expression            = "{" template-expression-param-name "}"
`,e+=`template-expression-param-name = 1*( %x00-7A / %x7C / %x7E-10FFFF ) ; every UTF8 character except { and } (from OpenAPI)
`,e+=`
`,e+=`; https://datatracker.ietf.org/doc/html/rfc3986#section-3.3
`,e+=`pchar               = unreserved / pct-encoded / sub-delims / ":" / "@"
`,e+=`unreserved          = ALPHA / DIGIT / "-" / "." / "_" / "~"
`,e+=`                    ; https://datatracker.ietf.org/doc/html/rfc3986#section-2.3
`,e+=`pct-encoded         = "%" HEXDIG HEXDIG
`,e+=`                    ; https://datatracker.ietf.org/doc/html/rfc3986#section-2.1
`,e+=`sub-delims          = "!" / "$" / "&" / "'" / "(" / ")"
`,e+=`                    / "*" / "+" / "," / ";" / "="
`,e+=`                    ; https://datatracker.ietf.org/doc/html/rfc3986#section-2.2
`,e+=`
`,e+=`; https://datatracker.ietf.org/doc/html/rfc5234#appendix-B.1
`,e+=`ALPHA               = %x41-5A / %x61-7A   ; A-Z / a-z
`,e+=`DIGIT               = %x30-39            ; 0-9
`,e+=`HEXDIG              = DIGIT / "A" / "B" / "C" / "D" / "E" / "F"
`,e}}const m=(s,e,t,i,r)=>(s===o.SEM_PRE&&r.push(["slash",n.charsToString(e,t,i)]),o.SEM_OK),y=(s,e,t,i,r)=>{if(s===o.SEM_PRE){if(Array.isArray(r)===!1)throw new Error("parser's user data must be an array");r.push(["path-template",n.charsToString(e,t,i)])}return o.SEM_OK},x=(s,e,t,i,r)=>(s===o.SEM_PRE&&r.push(["path-literal",n.charsToString(e,t,i)]),o.SEM_OK),g=(s,e,t,i,r)=>(s===o.SEM_PRE&&r.push(["template-expression",n.charsToString(e,t,i)]),o.SEM_OK),f=(s,e,t,i,r)=>(s===o.SEM_PRE&&r.push(["template-expression-param-name",n.charsToString(e,t,i)]),o.SEM_OK),E=new d,k=s=>{const e=new h;return e.ast=new u,e.ast.callbacks["path-template"]=y,e.ast.callbacks.slash=m,e.ast.callbacks["path-literal"]=x,e.ast.callbacks["template-expression"]=g,e.ast.callbacks["template-expression-param-name"]=f,{result:e.parse(E,"path-template",s),ast:e.ast}},w=s=>{try{return typeof s=="string"&&decodeURIComponent(s)!==s}catch{return!1}},I=s=>w(s)?s:encodeURIComponent(s).replace(/%5B/g,"[").replace(/%5D/g,"]"),A=["slash","path-literal","template-expression-param-name"],S=(s,e,t={})=>{const r={...{encoder:I},...t},a=k(s);if(!a.result.success)return s;const c=[];return a.ast.translate(c),c.filter(([l])=>A.includes(l)).map(([l,p])=>l==="template-expression-param-name"?Object.prototype.hasOwnProperty.call(e,p)?r.encoder(e[p],p):`{${p}}`:p).join("")};new d;new h;export{S as r};

class n{constructor(h,t){this.low=h,this.high=t,this.length=1+t-h}overlaps(h){return!(this.high<h.low||this.low>h.high)}touches(h){return!(this.high+1<h.low||this.low-1>h.high)}add(h){return new n(Math.min(this.low,h.low),Math.max(this.high,h.high))}subtract(h){return h.low<=this.low&&h.high>=this.high?[]:h.low>this.low&&h.high<this.high?[new n(this.low,h.low-1),new n(h.high+1,this.high)]:h.low<=this.low?[new n(h.high+1,this.high)]:[new n(this.low,h.low-1)]}toString(){return this.low==this.high?this.low.toString():this.low+"-"+this.high}}class l{constructor(h,t){this.ranges=[],this.length=0,h!=null&&this.add(h,t)}_update_length(){this.length=this.ranges.reduce((h,t)=>h+t.length,0)}add(h,t){var e=r=>{for(var s=0;s<this.ranges.length&&!r.touches(this.ranges[s]);)s++;for(var i=this.ranges.slice(0,s);s<this.ranges.length&&r.touches(this.ranges[s]);)r=r.add(this.ranges[s]),s++;i.push(r),this.ranges=i.concat(this.ranges.slice(s)),this._update_length()};return h instanceof l?h.ranges.forEach(e):(t==null&&(t=h),e(new n(h,t))),this}subtract(h,t){var e=r=>{for(var s=0;s<this.ranges.length&&!r.overlaps(this.ranges[s]);)s++;for(var i=this.ranges.slice(0,s);s<this.ranges.length&&r.overlaps(this.ranges[s]);)i=i.concat(this.ranges[s].subtract(r)),s++;this.ranges=i.concat(this.ranges.slice(s)),this._update_length()};return h instanceof l?h.ranges.forEach(e):(t==null&&(t=h),e(new n(h,t))),this}intersect(h,t){var e=[],r=s=>{for(var i=0;i<this.ranges.length&&!s.overlaps(this.ranges[i]);)i++;for(;i<this.ranges.length&&s.overlaps(this.ranges[i]);){var o=Math.max(this.ranges[i].low,s.low),g=Math.min(this.ranges[i].high,s.high);e.push(new n(o,g)),i++}};return h instanceof l?h.ranges.forEach(r):(t==null&&(t=h),r(new n(h,t))),this.ranges=e,this._update_length(),this}index(h){for(var t=0;t<this.ranges.length&&this.ranges[t].length<=h;)h-=this.ranges[t].length,t++;return this.ranges[t].low+h}toString(){return"[ "+this.ranges.join(", ")+" ]"}clone(){return new l(this)}numbers(){return this.ranges.reduce((h,t)=>{for(var e=t.low;e<=t.high;)h.push(e),e++;return h},[])}subranges(){return this.ranges.map(h=>({low:h.low,high:h.high,length:1+h.high-h.low}))}}var a=l;export{a as l};

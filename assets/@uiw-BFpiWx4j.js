import{a as V,b as _}from"./@babel-DhV5f2z5.js";import{r as l,j as w}from"./react-C96LbKGD.js";import{c as q,d as J,s as P,h as Q,f as X,a as Y,l as Z,b as $,e as ee,g as te,i as ae,j as ie,k as se,m as ne,E as j,n as re,o as le,p as fe,q as oe,r as ce,t as he,u as ue,v as de,w as me,x as ge,y as G,z as pe,A as y,B as Se,C as ye,D as be,F as xe,S as ve}from"./@codemirror-CIunNI7l.js";var I=function(e){e===void 0&&(e={});var{crosshairCursor:o=!1}=e,i=[];e.closeBracketsKeymap!==!1&&(i=i.concat(q)),e.defaultKeymap!==!1&&(i=i.concat(J)),e.searchKeymap!==!1&&(i=i.concat(P)),e.historyKeymap!==!1&&(i=i.concat(Q)),e.foldKeymap!==!1&&(i=i.concat(X)),e.completionKeymap!==!1&&(i=i.concat(Y)),e.lintKeymap!==!1&&(i=i.concat(Z));var a=[];return e.lineNumbers!==!1&&a.push($()),e.highlightActiveLineGutter!==!1&&a.push(ee()),e.highlightSpecialChars!==!1&&a.push(te()),e.history!==!1&&a.push(ae()),e.foldGutter!==!1&&a.push(ie()),e.drawSelection!==!1&&a.push(se()),e.dropCursor!==!1&&a.push(ne()),e.allowMultipleSelections!==!1&&a.push(j.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&a.push(re()),e.syntaxHighlighting!==!1&&a.push(le(pe,{fallback:!0})),e.bracketMatching!==!1&&a.push(fe()),e.closeBrackets!==!1&&a.push(oe()),e.autocompletion!==!1&&a.push(ce()),e.rectangularSelection!==!1&&a.push(he()),o!==!1&&a.push(ue()),e.highlightActiveLine!==!1&&a.push(de()),e.highlightSelectionMatches!==!1&&a.push(me()),e.tabSize&&typeof e.tabSize=="number"&&a.push(ge.of(" ".repeat(e.tabSize))),a.concat([G.of(i.flat())]).filter(Boolean)},Ee=y.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),Ce=function(e){e===void 0&&(e={});var{indentWithTab:o=!0,editable:i=!0,readOnly:a=!1,theme:u="light",placeholder:f="",basicSetup:c=!0}=e,n=[];switch(o&&n.unshift(G.of([Se])),c&&(typeof c=="boolean"?n.unshift(I()):n.unshift(I(c))),f&&n.unshift(ye(f)),u){case"light":n.push(Ee);break;case"dark":n.push(be);break;case"none":break;default:n.push(u);break}return i===!1&&n.push(y.editable.of(!1)),a&&n.push(j.readOnly.of(!0)),[...n]},ke=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(e=>t.state.sliceDoc(e.from,e.to)),selectedText:t.state.selection.ranges.some(e=>!e.empty)}),F=xe.define(),We=[];function Ke(t){var{value:e,selection:o,onChange:i,onStatistics:a,onCreateEditor:u,onUpdate:f,extensions:c=We,autoFocus:n,theme:v="light",height:E=null,minHeight:m=null,maxHeight:C=null,width:k=null,minWidth:W=null,maxWidth:K=null,placeholder:O="",editable:T=!0,readOnly:B=!1,indentWithTab:H=!0,basicSetup:L=!0,root:z,initialState:b}=t,[g,M]=l.useState(),[s,h]=l.useState(),[p,S]=l.useState(),D=y.theme({"&":{height:E,minHeight:m,maxHeight:C,width:k,minWidth:W,maxWidth:K},"& .cm-scroller":{height:"100% !important"}}),A=y.updateListener.of(r=>{if(r.docChanged&&typeof i=="function"&&!r.transactions.some(U=>U.annotation(F))){var x=r.state.doc,N=x.toString();i(N,r)}a&&a(ke(r))}),R=Ce({theme:v,editable:T,readOnly:B,placeholder:O,indentWithTab:H,basicSetup:L}),d=[A,D,...R];return f&&typeof f=="function"&&d.push(y.updateListener.of(f)),d=d.concat(c),l.useLayoutEffect(()=>{if(g&&!p){var r={doc:e,selection:o,extensions:d},x=b?j.fromJSON(b.json,r,b.fields):j.create(r);if(S(x),!s){var N=new y({state:x,parent:g,root:z});h(N),u&&u(N,x)}}return()=>{s&&(S(void 0),h(void 0))}},[g,p]),l.useEffect(()=>{t.container&&M(t.container)},[t.container]),l.useEffect(()=>()=>{s&&(s.destroy(),h(void 0))},[s]),l.useEffect(()=>{n&&s&&s.focus()},[n,s]),l.useEffect(()=>{s&&s.dispatch({effects:ve.reconfigure.of(d)})},[v,c,E,m,C,k,W,K,O,T,B,H,L,i,f]),l.useEffect(()=>{if(e!==void 0){var r=s?s.state.doc.toString():"";s&&e!==r&&s.dispatch({changes:{from:0,to:r.length,insert:e||""},annotations:[F.of(!0)]})}},[e,s]),{state:p,setState:S,view:s,setView:h,container:g,setContainer:M}}var Oe=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Te=l.forwardRef((t,e)=>{var{className:o,value:i="",selection:a,extensions:u=[],onChange:f,onStatistics:c,onCreateEditor:n,onUpdate:v,autoFocus:E,theme:m="light",height:C,minHeight:k,maxHeight:W,width:K,minWidth:O,maxWidth:T,basicSetup:B,placeholder:H,indentWithTab:L,editable:z,readOnly:b,root:g,initialState:M}=t,s=V(t,Oe),h=l.useRef(null),{state:p,view:S,container:D,setContainer:A}=Ke({root:g,value:i,autoFocus:E,theme:m,height:C,minHeight:k,maxHeight:W,width:K,minWidth:O,maxWidth:T,basicSetup:B,placeholder:H,indentWithTab:L,editable:z,readOnly:b,selection:a,onChange:f,onStatistics:c,onCreateEditor:n,onUpdate:v,extensions:u,initialState:M});l.useImperativeHandle(e,()=>({editor:h.current,state:p,view:S}),[h,D,p,S]);var R=l.useCallback(r=>{h.current=r,A(r)},[A]);if(typeof i!="string")throw new Error("value must be typeof string but got "+typeof i);var d=typeof m=="string"?"cm-theme-"+m:"cm-theme";return w.jsx("div",_({ref:R,className:""+d+(o?" "+o:"")},s))});Te.displayName="CodeMirror";export{Te as R};

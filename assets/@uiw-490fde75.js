import{a as V,b as _}from"./@babel-405a847c.js";import{r,j as w}from"./react-8aefe96b.js";import{c as q,d as J,s as P,h as Q,f as X,a as Y,l as Z,b as $,e as ee,g as te,i as ae,j as ie,k as se,m as ne,E as N,n as re,o as le,p as fe,q as oe,r as ce,t as he,u as ue,v as de,w as me,x as ge,y as F,z as pe,A as S,B as Se,C as ye,D as be,F as xe,S as ve}from"./@codemirror-81197929.js";var I=function(e){e===void 0&&(e={});var{crosshairCursor:c=!1}=e,i=[];e.closeBracketsKeymap!==!1&&(i=i.concat(q)),e.defaultKeymap!==!1&&(i=i.concat(J)),e.searchKeymap!==!1&&(i=i.concat(P)),e.historyKeymap!==!1&&(i=i.concat(Q)),e.foldKeymap!==!1&&(i=i.concat(X)),e.completionKeymap!==!1&&(i=i.concat(Y)),e.lintKeymap!==!1&&(i=i.concat(Z));var t=[];return e.lineNumbers!==!1&&t.push($()),e.highlightActiveLineGutter!==!1&&t.push(ee()),e.highlightSpecialChars!==!1&&t.push(te()),e.history!==!1&&t.push(ae()),e.foldGutter!==!1&&t.push(ie()),e.drawSelection!==!1&&t.push(se()),e.dropCursor!==!1&&t.push(ne()),e.allowMultipleSelections!==!1&&t.push(N.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&t.push(re()),e.syntaxHighlighting!==!1&&t.push(le(pe,{fallback:!0})),e.bracketMatching!==!1&&t.push(fe()),e.closeBrackets!==!1&&t.push(oe()),e.autocompletion!==!1&&t.push(ce()),e.rectangularSelection!==!1&&t.push(he()),c!==!1&&t.push(ue()),e.highlightActiveLine!==!1&&t.push(de()),e.highlightSelectionMatches!==!1&&t.push(me()),e.tabSize&&typeof e.tabSize=="number"&&t.push(ge.of(" ".repeat(e.tabSize))),t.concat([F.of(i.flat())]).filter(Boolean)},Ee=S.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),Ce=function(e){e===void 0&&(e={});var{indentWithTab:c=!0,editable:i=!0,readOnly:t=!1,theme:u="light",placeholder:f="",basicSetup:h=!0}=e,n=[];switch(c&&n.unshift(F.of([Se])),h&&(typeof h=="boolean"?n.unshift(I()):n.unshift(I(h))),f&&n.unshift(ye(f)),u){case"light":n.push(Ee);break;case"dark":n.push(be);break;case"none":break;default:n.push(u);break}return i===!1&&n.push(S.editable.of(!1)),t&&n.push(N.readOnly.of(!0)),[...n]},ke=a=>({line:a.state.doc.lineAt(a.state.selection.main.from),lineCount:a.state.doc.lines,lineBreak:a.state.lineBreak,length:a.state.doc.length,readOnly:a.state.readOnly,tabSize:a.state.tabSize,selection:a.state.selection,selectionAsSingle:a.state.selection.asSingle().main,ranges:a.state.selection.ranges,selectionCode:a.state.sliceDoc(a.state.selection.main.from,a.state.selection.main.to),selections:a.state.selection.ranges.map(e=>a.state.sliceDoc(e.from,e.to)),selectedText:a.state.selection.ranges.some(e=>!e.empty)}),R=xe.define(),We=[];function Ke(a){var{value:e,selection:c,onChange:i,onStatistics:t,onCreateEditor:u,onUpdate:f,extensions:h=We,autoFocus:n,theme:v="light",height:E=null,minHeight:d=null,maxHeight:C=null,width:k=null,minWidth:W=null,maxWidth:K=null,placeholder:O="",editable:T=!0,readOnly:B=!1,indentWithTab:H=!0,basicSetup:L=!0,root:j,initialState:y}=a,[m,M]=r.useState(),[s,o]=r.useState(),[g,p]=r.useState(),z=S.theme({"&":{height:E,minHeight:d,maxHeight:C,width:k,minWidth:W,maxWidth:K},"& .cm-scroller":{height:"100% !important"}}),D=S.updateListener.of(l=>{if(l.docChanged&&typeof i=="function"&&!l.transactions.some(U=>U.annotation(R))){var x=l.state.doc,A=x.toString();i(A,l)}t&&t(ke(l))}),G=Ce({theme:v,editable:T,readOnly:B,placeholder:O,indentWithTab:H,basicSetup:L}),b=[D,z,...G];return f&&typeof f=="function"&&b.push(S.updateListener.of(f)),b=b.concat(h),r.useEffect(()=>{if(m&&!g){var l={doc:e,selection:c,extensions:b},x=y?N.fromJSON(y.json,l,y.fields):N.create(l);if(p(x),!s){var A=new S({state:x,parent:m,root:j});o(A),u&&u(A,x)}}return()=>{s&&(p(void 0),o(void 0))}},[m,g]),r.useEffect(()=>M(a.container),[a.container]),r.useEffect(()=>()=>{s&&(s.destroy(),o(void 0))},[s]),r.useEffect(()=>{n&&s&&s.focus()},[n,s]),r.useEffect(()=>{s&&s.dispatch({effects:ve.reconfigure.of(b)})},[v,h,E,d,C,k,W,K,O,T,B,H,L,i,f]),r.useEffect(()=>{if(e!==void 0){var l=s?s.state.doc.toString():"";s&&e!==l&&s.dispatch({changes:{from:0,to:l.length,insert:e||""},annotations:[R.of(!0)]})}},[e,s]),{state:g,setState:p,view:s,setView:o,container:m,setContainer:M}}var Oe=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Te=r.forwardRef((a,e)=>{var{className:c,value:i="",selection:t,extensions:u=[],onChange:f,onStatistics:h,onCreateEditor:n,onUpdate:v,autoFocus:E,theme:d="light",height:C,minHeight:k,maxHeight:W,width:K,minWidth:O,maxWidth:T,basicSetup:B,placeholder:H,indentWithTab:L,editable:j,readOnly:y,root:m,initialState:M}=a,s=V(a,Oe),o=r.useRef(null),{state:g,view:p,container:z}=Ke({container:o.current,root:m,value:i,autoFocus:E,theme:d,height:C,minHeight:k,maxHeight:W,width:K,minWidth:O,maxWidth:T,basicSetup:B,placeholder:H,indentWithTab:L,editable:j,readOnly:y,selection:t,onChange:f,onStatistics:h,onCreateEditor:n,onUpdate:v,extensions:u,initialState:M});if(r.useImperativeHandle(e,()=>({editor:o.current,state:g,view:p}),[o,z,g,p]),typeof i!="string")throw new Error("value must be typeof string but got "+typeof i);var D=typeof d=="string"?"cm-theme-"+d:"cm-theme";return w.jsx("div",_({ref:o,className:""+D+(c?" "+c:"")},s))});Te.displayName="CodeMirror";export{Te as R};
